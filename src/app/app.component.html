
    <p-table #dt selectionMode="multiple" [exportHeader]="'customExportHeader'"  [(selection)]="selectedProducts"   rowGroupMode="rowspan" groupRowsBy="dateOfRelease" sortField="dateOfRelease"   dataKey="id"  [columns]="cols"    [showCurrentPageReport]="true" scrollHeight="800px" sortMode="multiple" [value]="launchMaturity"   (onLazyLoad)="loadCustomers($event)"  (sortFunction)="customSort($event)"
    [rows]="10" [paginator]="true"  [loading]="loading" [globalFilterFields]="['date','ldId','projectNo',  'maturityOrderNo','category','amount','metricType']">
  
  <ng-template pTemplate="caption">
    <div class="flex">
        <button type="button" pButton pRipple icon="pi pi-file" (click)="dt.exportCSV()" class="mr-2" pTooltip="CSV" tooltipPosition="bottom"></button>
        <button type="button" pButton pRipple icon="pi pi-file-excel" (click)="exportExcel()" class="p-button-success mr-2"  pTooltip="XLS" tooltipPosition="bottom"></button>
    </div>
  </ng-template>
  
  <ng-template pTemplate="header"  >
      
      <tr   >
          <th>
              <p-columnFilter type="text" field="date"></p-columnFilter>
          </th>
          <th>
              <p-columnFilter type="text" field="ldId"></p-columnFilter>
          </th>

          <th>
              <p-columnFilter type="text" field="projectNo"></p-columnFilter>
          </th>
        
          <th>
              <p-columnFilter type="text" field="maturityOrderNo"></p-columnFilter>
          </th>
          <th>
              <p-columnFilter type="text" field="category"></p-columnFilter>
          </th>
          <th>
              <p-columnFilter type="text" field="amount"></p-columnFilter>
          </th>
          <th>
              <p-columnFilter type="text" field="metricType"></p-columnFilter>
          </th>
      </tr>
      <tr style=" position: -webkit-sticky;
      position: sticky;
      background-color:red;
      color:white;
      top:0px;
      z-index:1"  >
          <th   pResizableColumn pSortableColumn="date"  >Date <p-sortIcon field="date"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="ldId">ldId <p-sortIcon field="ldId"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="projectNo">projectNo <p-sortIcon field="projectNo"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="maturityOrderNo">maturityOrderNo <p-sortIcon field="maturityOrderNo"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="category">category <p-sortIcon field="category"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="amount">amount <p-sortIcon field="amount"></p-sortIcon></th>
          <th pResizableColumn pSortableColumn="metricType">metricType <p-sortIcon field="metricType"></p-sortIcon></th>

      </tr>

  </ng-template>

  <ng-template pTemplate="body"  let-customer let-index="rowIndex" let-rowIndex="rowIndex" let-rowgroup="rowgroup"
  let-rowspan="rowspan">
      <tr *ngIf=" {dimMetricType: getLaunchDimensionMetricType(customer.ldId)}">

          <td *ngIf="rowgroup" [attr.rowspan]="rowspan">{{customer.dateOfRelease }}</td>
          <td>{{customer.ldId }}</td>
          <td>{{customer.projectNo}}</td>
          <td>{{customer.maturityOrderNo}}</td>
          <td>{{customer.category}}</td>
          <td>{{customer.amount}}</td>
          <td>{{customer.dimMetricType }}</td>
        


      </tr>
  </ng-template>
</p-table>

